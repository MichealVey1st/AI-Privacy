# Video Processing Script (Version 4)

## Overview

This script processes a video by blurring faces detected in each frame and saves the output while preserving the original audio. It uses OpenCV for face detection and video manipulation, FFmpeg for audio extraction and merging, and YOLO for face detection.

---

## Key Features

1. **Face Detection and Blurring**:
   - Uses the YOLOv3 model trained on a face dataset.
   - Tracks faces across frames to maintain consistent blurring.
2. **Audio Preservation**:
   - Extracts the audio from the original video using FFmpeg.
   - Merges the blurred video with the original audio.
3. **Temporary File Handling**:
   - Processes video frames into a temporary file before finalizing output.
   - Extracts and saves audio into a temporary file.

---

## Script Structure

### Libraries Used

- **cv2**: OpenCV library for video and image processing.
- **argparse**: Parses command-line arguments.
- **numpy**: Handles numerical operations for bounding box calculations.
- **tqdm**: Displays a progress bar during video processing.
- **os**: Manages file paths and directories.
- **subprocess**: Executes external commands, including FFmpeg.
- **ffmpeg**: Extracts and merges video and audio streams.

### Workflow

1. **Initialize YOLO Model**
   - Load YOLO configuration and weights (`yolov3-face.cfg` and `yolov3-wider_16000.weights`).
   - Set computation backend and target to CPU.

2. **Video Processing**
   - Read video properties (frame dimensions, FPS, etc.).
   - Process each frame:
     - Detect faces using YOLO.
     - Blur detected faces.
     - Track faces across frames to maintain consistent blurring.
   - Save processed frames to a temporary video file.

3. **Audio Processing**
   - Extract audio from the original video using FFmpeg.

4. **Final Video Assembly**
   - Merge the blurred video with the extracted audio into the final output file using FFmpeg.

## Future implementations

1. **Voice Distortion**
    - The distrortion of voices still needs to be implemented.

2. **Sign Blurring**
    - The blurring of signs and other sensitive items.

3. **Metadata Sanitizing**
    - The implementation of fake data to mask metadata.

4. **Possible individual selection**
    - Maybe implement a way to select individual faces and or voices.
